{# Base layout macros #}
{% macro page_header(title, subtitle="") %}
<div class="header">
    <h1>{{ title }}</h1>
    {% if subtitle %}<p>{{ subtitle }}</p>{% endif %}
</div>
{% endmacro %}

{# Form selection macros #}
{% macro selection_card(title, icon="", id="", name="", options=[], placeholder="", disabled=false, required=false) %}
<div class="selection-card">
    <h3>
        {% if icon %}{{ icon }} {% endif %}{{ title }}
    </h3>
    <select id="{{ id }}" name="{{ name }}" {% if disabled %}disabled{% endif %} {% if required %}required{% endif %}>
        <option value="">{{ placeholder }}</option>
        {% for option in options %}
            {% if option.league_id is defined %}
                {# Handle league data structure #}
                <option value="{{ option.league_id }}" {% if option.is_default %}selected{% endif %}>
                    {{ option.league_name }}
                </option>
            {% elif option.hero_id is defined %}
                {# Handle hero data structure #}
                <option value="{{ option.hero_id }}">
                    {{ option.hero_name }}
                </option>
            {% elif option.player_account_id is defined %}
                {# Handle player data structure #}
                <option value="{{ option.player_account_id }}">
                    {{ option.player_name }}
                </option>
            {% elif option.team_id is defined %}
                {# Handle team data structure #}
                <option value="{{ option.team_id }}">
                    {{ option.team_name }}
                </option>
            {% else %}
                {# Fallback for generic value/label structure #}
                <option value="{{ option.value }}" {% if option.selected %}selected{% endif %}>
                    {{ option.label }}
                </option>
            {% endif %}
        {% endfor %}
    </select>
</div>
{% endmacro %}

{# Stats table macros #}
{% macro stats_table(stats_data, title, priority_class="") %}
<div class="stats-section {{ priority_class }}">
    <h3>{{ title }}</h3>
    <div class="stats-table">
        <div class="table-header">
            <div class="metric-col">Metric</div>
            <div class="value-col">Mean ± Std</div>
            <div class="range-col">Range</div>
            <div class="quartiles-col">Quartiles</div>
            <div class="count-col">Games</div>
        </div>
        
        {% if stats_data.last_hits %}
        <div class="table-row">
            <div class="metric-col">Last Hits at 5min</div>
            <div class="value-col {% if priority_class == 'primary' %}primary-value{% endif %}">
                {{ stats_data.last_hits.mean|round(1) }} ± {{ stats_data.last_hits.std|round(1) }}
            </div>
            <div class="range-col">{{ stats_data.last_hits.min }}-{{ stats_data.last_hits.max }}</div>
            <div class="quartiles-col">Q1: {{ stats_data.last_hits.q25|round(1) }} | Q3: {{ stats_data.last_hits.q75|round(1) }}</div>
            <div class="count-col">{{ stats_data.last_hits.count }}</div>
        </div>
        {% endif %}
        
        {% if stats_data.kills %}
        <div class="table-row">
            <div class="metric-col">Kills</div>
            <div class="value-col {% if priority_class == 'primary' %}primary-value{% endif %}">
                {{ stats_data.kills.mean|round(1) }} ± {{ stats_data.kills.std|round(1) }}
            </div>
            <div class="range-col">{{ stats_data.kills.min }}-{{ stats_data.kills.max }}</div>
            <div class="quartiles-col">Q1: {{ stats_data.kills.q25|round(1) }} | Q3: {{ stats_data.kills.q75|round(1) }}</div>
            <div class="count-col">{{ stats_data.kills.count }}</div>
        </div>
        {% endif %}
    </div>
</div>
{% endmacro %}

{# Context selector macro #}
{% macro context_selector() %}
<div class="time-context-selector">
    <div class="context-tabs">
        <button class="context-tab active" data-context="tournament">Tournament</button>
        <button class="context-tab" data-context="patch">Current Patch</button>
        <button class="context-tab" data-context="all-time">All Time</button>
    </div>
    <div class="context-info">
        <small>Currently showing: <span id="current-context">Tournament</span> data</small>
    </div>
</div>
{% endmacro %}

{# Stat card macro for compact display #}
{% macro stat_card(metric_name, stats, priority="") %}
<div class="stat-card {{ priority }}">
    <h4>{{ metric_name }}</h4>
    <div class="stat-value">{{ stats.mean|round(1) }}</div>
    <div class="stat-label">±{{ stats.std|round(1) }} ({{ stats.count }} games)</div>
    <div class="stat-range">Range: {{ stats.min }}-{{ stats.max }}</div>
    <div class="stat-quartiles">Q1: {{ stats.q25|round(1) }} | Q3: {{ stats.q75|round(1) }}</div>
</div>
{% endmacro %}

{# Loading state macro #}
{% macro loading_state(message="Loading...") %}
<div class="loading-state">
    <div class="spinner"></div>
    <p>{{ message }}</p>
</div>
{% endmacro %}

{# Error state macro #}
{% macro error_state(message="An error occurred") %}
<div class="error-state">
    <div class="error-icon">⚠️</div>
    <p>{{ message }}</p>
</div>
{% endmacro %}
